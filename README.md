# Telegram 机器人管理系统

这是一个功能完善的 Telegram 机器人管理系统，允许您通过网页界面轻松管理 Telegram 机器人的交互内容和用户体验。

## 主要功能

1. **自定义键盘按钮**：通过网页后台可视化管理机器人的键盘菜单
2. **自动回复内容**：设置关键词触发的自动回复内容
3. **多媒体支持**：支持在回复中包含图片、视频等媒体文件
4. **实时更新**：使用 Redis 发布/订阅机制实现按钮和回复内容的实时更新
5. **用户数据统计**：记录并统计用户活跃度和使用情况
6. **管理员界面**：直观的网页管理后台

## 技术架构

- **后端**：Python 3.7+
- **机器人 API**：python-telegram-bot 20.5+
- **网页后台**：Flask 2.0+
- **数据存储**：SQLite 数据库
- **实时通信**：Redis 发布/订阅

## 安装指南

### 前置条件

确保您的系统已安装：
- Python 3.7 或更高版本
- Redis 服务器（可选，用于实时更新功能）

### 安装步骤

1. **克隆或下载代码库**:
   ```bash
   git clone https://your-repository-url/telegramBOT.git
   cd telegramBOT
   ```

2. **安装所需依赖**:
   ```bash
   pip install -r requirements.txt
   ```

3. **配置机器人**:
   编辑 `config.py` 文件，设置您的:
   - Telegram 机器人 TOKEN
   - 管理员用户名和密码
   - 其他配置选项

4. **启动服务**:
   ```bash
   bash start.sh
   ```
   或者手动启动各个组件:
   ```bash
   # 启动管理后台
   python admin_web.py
   
   # 启动机器人
   python bot.py
   ```

5. **访问管理后台**:
   在浏览器中打开 http://localhost:5000，使用您配置的管理员账号登录。

## 使用说明

### 管理键盘按钮

1. 登录管理后台
2. 点击「管理按钮」选项
3. 添加、修改或删除按钮
4. 设置按钮显示位置和触发动作

### 管理自动回复

1. 登录管理后台
2. 点击「管理回复」选项
3. 添加新的触发词和对应回复内容
4. 可选择添加图片等媒体文件

### 实时更新

所有在管理后台的修改将通过以下方式实时同步到机器人：
1. Redis 发布/订阅机制（如果启用）
2. 文件标志更新机制（备用方案）

## 文件结构说明

- `bot.py`: 机器人主程序
- `admin_web.py`: 管理后台 Web 服务
- `config.py`: 配置文件
- `templates/`: HTML 模板文件
- `static/`: 静态资源文件
- `requirements.txt`: 项目依赖清单
- `start.sh`: 启动脚本

## 自定义开发

如需扩展功能，主要修改以下文件：
1. `bot.py` - 添加新的命令处理器
2. `admin_web.py` - 扩展管理后台功能
3. `templates/` - 修改网页界面

## 故障排除

1. **机器人无响应**
   - 检查 TOKEN 是否正确
   - 确认 bot.py 程序正在运行
   
2. **管理后台无法访问**
   - 确认 admin_web.py 正在运行
   - 检查端口是否被占用

3. **按钮更新不生效**
   - 如使用 Redis，检查 Redis 服务是否正常运行
   - 尝试重启机器人服务

## 许可证

本项目基于 MIT 许可证开源。